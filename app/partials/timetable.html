<div class="top-nav">
  <h1 class="logo">Pluff</h1>

  <ul class="nav-list">
    <li class="main"><a href="/" translate>TIMETABLE</a></li>
    <li><a ng-dialog="partials/dialog-holidays.html" ng-dialog-controller="HolidaysCtrl"><span translate>HOLIDAYS</span></a></li>
    <li><a ng-dialog="partials/dialog-free-rooms.html" ng-dialog-controller="RoomsCtrl"><span translate>FREE_ROOMS</span></a></li>
  </ul>
  <div class="nav-right">
    <h2 class="nav-timetable-name" ng-show="tableTitle">{{tableTitle}}</h2>
    <div class="nav-search">
      <a href="#" ng-click="showSearchFormFunc()">
        <svg version="1.1" width="20" height="20" viewBox="0 0 16 16"><path d="M15.56 15.56c-0.587 0.587-1.538 0.587-2.125 0l-2.652-2.652c-1.090 0.699-2.379 1.116-3.771 1.116-3.872 0-7.012-3.139-7.012-7.012s3.14-7.012 7.012-7.012c3.873 0 7.012 3.139 7.012 7.012 0 1.391-0.417 2.68-1.116 3.771l2.652 2.652c0.587 0.587 0.587 1.538 0 2.125zM7.012 2.003c-2.766 0-5.009 2.242-5.009 5.009s2.243 5.009 5.009 5.009c2.766 0 5.009-2.242 5.009-5.009s-2.242-5.009-5.009-5.009z"></path></svg>
      </a>

      <div class="search-form" ng-if="showSearchForm">
        <angucomplete-alt id="search-query"
          placeholder="{{::'SEARCH_PLACEHOLDER' | translate}}"
          pause="100"
          selected-object="searchSelected"
          local-data="searchAuto"
          search-fields="name,description"
          description-field="description"
          title-field="name"
          minlength="2"
          auto-match="true"
          text-searching="{{::'SEARCH_BUSY' | translate}}"
          text-no-results="{{::'SEARCH_NO_RESULTS' | translate}}"
          input-class=""
          focus-out="searchFormFocusOut()" />
      </div>
    </div>
  </div>
</div>

<div class="week-nav">
  <a class="week-previous" ng-click="previousWeek()" ng-class="{'old-week': isOldWeek()}">
    <svg version="1.1" width="25" height="25" viewBox="0 0 80 80">
      <path d="M57.596 69.672c1.072 1.084 1.072 2.832 0 3.916s-2.804 1.084-3.876 0l-31.32-31.628c-1.072-1.084-1.072-2.836 0-3.916l31.32-31.632c1.072-1.084 2.804-1.084 3.876 0s1.072 2.832 0 3.916l-28.56 29.672 28.56 29.672z"></path>
    </svg>
  </a>
  <a class="week-current" ng-click="currentWeek()">week {{weekNumberUsed}}</a>
  <a class="week-next" ng-click="nextWeek()">
    <svg version="1.1" width="25" height="25" viewBox="0 0 80 80">
      <path transform="rotate(180 40 40)" d="M57.596 69.672c1.072 1.084 1.072 2.832 0 3.916s-2.804 1.084-3.876 0l-31.32-31.628c-1.072-1.084-1.072-2.836 0-3.916l31.32-31.632c1.072-1.084 2.804-1.084 3.876 0s1.072 2.832 0 3.916l-28.56 29.672 28.56 29.672z"></path>
    </svg>
  </a>
  <div class="languages" ng-controller="LanguageCtrl">
    <a ng-click="switch('nl')">NL</a>
    <a ng-click="switch('en')">EN</a>
    <a ng-click="switch('de')">DE</a>
  </div>
</div>

<div class="timetable">
  <div class="day" ng-repeat="day in weeks[(weekNumberUsed - 1)]" ng-class="{'activeDay': isActiveDay($index+1)}">
    <h3>
      {{::'DAY_' + ($index+1) | translate}}
    </h3>
    <div class="day-info">
      {{currentDayDate($index+1).format('D-M')}} <strong> &ndash; {{countLessons(day)}} {{::'LESSONS' | translate}}</strong>
    </div>
    <div class="hours">
      <div class="line" style="top:{{calculateLine()}}" ng-if="isActiveDay($index+1)"></div>
      <div ng-repeat="hour in day" class="hour break-{{::hourBreaks[hour.number]}}">
        <div class="hour-number">{{::hour.number}}</div>

        <div class="lesson" ng-if="::hour.lessons.length > 0" ng-init="::lesson = hour.lessons[0]; showExtra = false" ng-style="::{ background: lesson.color }">
          <div class="lesson-text">
            {{::lesson.start}} - {{::lesson.end}}<br>
            {{::lesson.subject}}

            <span ng-if="::lesson.teacher !== '-'">
              - <a ng-click="teacherDialog(lesson.teacher)">{{::lesson.teacher}}</a>
            </span><br>

            <small>
              <span ng-if="::lesson.room !== ''">
                <a href="search/room/{{::encode(lesson.room)}}">{{::lesson.room}}</a> -
              </span>

              <span ng-repeat="class in lesson.classes">
                <a href="search/class/{{::encode(class)}}">{{::class}}</a>{{ (!$last) ? ',' : ''}}
              </span>
            </small>
          </div><!-- .lesson-text -->
          <div class="multiple-hours" ng-if="hour.lessons.length > 1">
            <a href="#" class="multiple-hours-icon" ng-click="showExtra = !showExtra" ng-mouseenter="showExtra = true" ng-mouseleave="showExtra = false">+</a>

            <div class="hidden-lessons" ng-show="showExtra" ng-mouseenter="showExtra = true" ng-mouseleave="showExtra = false">
              <div ng-repeat="lesson in hour.lessons" ng-show="!$first">
                <div class="lesson-text">
                  {{::lesson.subject}}

                  <span ng-if="::lesson.teacher !== '-'">
                    - <a ng-click="teacherDialog(lesson.teacher)">{{::lesson.teacher}}</a>
                  </span><br>

                  <small>
                    <span ng-if="::lesson.room !== ''">
                      <a href="search/room/{{::encode(lesson.room)}}">{{::lesson.room}}</a> -
                    </span>

                    <span ng-repeat="class in lesson.classes">
                      <a href="search/class/{{::encode(class)}}">{{::class}}</a>{{ (!$last) ? ',' : ''}}
                    </span>
                  </small>
                </div>
              </div>
            </div><!-- .hidden-lessons -->

          </div><!-- .multiple-hours -->
        </div><!-- .lesson -->

      </div><!-- .hour -->
    </div><!-- .hours -->
  </div><!-- .day -->
</div><!-- .timetable -->
